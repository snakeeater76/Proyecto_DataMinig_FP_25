---
title: "Proyecto DataMining 2025"
author: "Fredy Picen"
date: "2025-10-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


```{r}
## Se inicia con la revision de los archivos que el INE para Imports y Exports

#1. Se bajan los archivos desde el sitio del INE, los archivos de imports se ven bastante uniformes, unos se deben transformar a hoja de calculo de excel, pero, en la parte de exports, el archivo que se debe transformar inicialmente para que sea igual a los demas archivos.

#2. Esta transformacion se hara en excel, ya que la estrategia sera establecer una sola base de datos para imports y exports para que desde un solo data set se puedan hacer las consultas.

21-10-2025

#3. Se revisa cada hoja de excel y se evidencia que hay diferencias, en algunos casos de fondo:
    
    #a. En el año 2022 y 2023 no existe la columna MES, lo que ya de por si limita el analisis o encontrar un patron que podria         ser fundamental.
    #b. Cada archivo, difiere en la cantidad de filas, sin embargo, aca el uso de la columna año es fundamental para segmentar
    #c. En el año 23, se elimina una columna que se llama "CodigoTipoDeComercio", ya que unicamente contiene 0´s.
    
#Como se menciono se buscara limpiar la data dentro de Excel, pero, en R se trabajaara la integración para crear datasets.

library(readxl)
library(dplyr)

ruta <- "C:/Users/fredy/Documents/Maestria Ciencias Computacion Ciencia Datos/4. Cuarto Trimestre/Introduccion Mineria de Datos/Proyecto Final/Fase 1/Importaciones"


archivos_ini <- list.files(path = ruta, pattern = "\\.xlsx$", full.names = TRUE)
print(archivos_ini)

#Uniendo todos los archivos
dataset_imports <- archivos_ini %>%
  lapply(read_excel) %>%
  bind_rows()
  print(dataset_imports)
  
#Se hace un primer intento de juntar todos los datasets pero emite un error, se vuele a revisar los datos y se estandarizan los encabezados, se va con segunda iteracion.
  
  ruta <- "C:/Users/fredy/Documents/Maestria Ciencias Computacion Ciencia Datos/4. Cuarto Trimestre/Introduccion Mineria de Datos/Proyecto Final/Fase 1/Importaciones"

archivos_ini <- list.files(path = ruta, pattern = "\\.xlsx$", full.names = TRUE)
print(archivos_ini)

#Uniendo todos los archivos
dataset_imports <- archivos_ini %>%
  lapply(read_excel) %>%
  bind_rows()
  print(dataset_imports)
  
  
  
  
  

```

```{r}
#22-101-2025
#Se crea el dataset Exports

library(readxl)
library(dplyr)

ruta_2 <- "C:/Users/fredy/Documents/Maestria Ciencias Computacion Ciencia Datos/4. Cuarto Trimestre/Introduccion Mineria de Datos/Proyecto Final/Fase 1/Exportaciones"

archivos_ini1 <- list.files(path = ruta_2, pattern = "\\.xlsx$", full.names = TRUE)
print(archivos_ini1)

#Uniendo todos los archivos
dataset_exports <- archivos_ini1 %>%
  lapply(read_excel) %>%
  bind_rows()
  print(dataset_exports)


```
```{r}
#Aplicacion de Apriori al dataset de Imports

library(arules)

reglasimport <- apriori(dataset_imports, parameter = list(support=0.2, confidence = 0.5))

inspect(reglasimport[0:28])

```


